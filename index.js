const fs = require('fs');
var convert = require('xml-js');
const json2xls = require("json2xls");
const util = require("util");
const { version } = require('os');


function listarArquivosEPastasDeUmDiretorio(diretorio, arquivos) {
    
    if(!arquivos)
        arquivos = [];

    let listaDeArquivos = fs.readdirSync(diretorio);
    for(let k in listaDeArquivos) {
        let stat = fs.statSync(diretorio + '/' + listaDeArquivos[k]);
        if(stat.isDirectory())
            listarArquivosEPastasDeUmDiretorio(diretorio + '/' + listaDeArquivos[k], arquivos);
        else
            arquivos.push(diretorio + '/' + listaDeArquivos[k]);
    }
    
    return arquivos;

}

let lista = listarArquivosEPastasDeUmDiretorio('./testeacimel');

var testenotas = [];
var arrayNota = [];


 for (var i = 0; i < lista.length; i++){
    a = lista.slice(i,i)
    var listaString = lista[i].toString();

     var xml = require('fs').readFileSync(listaString, "utf-8");   
     var options = { compact: true, spaces: 4, ignoreComment: true, ignoreCdata: true };
     var result = convert.xml2js(xml, options);

        if ((result.nfeProc.NFe.infNFe.det._attributes) === undefined) {


            for( var idet = 0; idet < result.nfeProc.NFe.infNFe.det.length; idet++) {
        
                if (
                result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00 != undefined
                )

                { 
                    var notas = {
    
                        Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                        DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                        tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                        CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                        NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                        CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                        NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                        CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                        EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                        DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                        NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                        CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                        cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                        CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                        Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                        ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                        ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                        CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.CST._text,
                        BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vBC,
                        PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.pICMS),
                        ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vICMSOp,
                        PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.pDif,
                        ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vICMSDif,
                        ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vICMS,
                        BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vBCFCP,
                        PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.pFCP,
                        ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vFCP,
                        ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.ModBCST,
                        PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.pMVAST, 
                        PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.pRedBCST, 
                        BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vBCST,
                        AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.pICMSST,
                        ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vICMSST,
                        valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vBCFCPST,
                        PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.pFCPST,                           
                        valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vFCPST,
                        ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vICMSDeson,
                        ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vBCSTRet, 
                        AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.pST,
                        ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vICMSSubstituto,
                        ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vICMSSTRet,
                        ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vBCFCPSTRet,
                        PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.pFCPSTRet,
                        valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vFCPSTRet,
                        PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.pRedBCEfet,
                        valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vBCEfet,
                        aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.pICMSEfet,
                        valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS00.vICMSEfet,
                        valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                        valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                        valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                        valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                        CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                        valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                        CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                        valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                //         ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST,
                //         ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                //         ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                //         ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                //         ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                //         ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                //         ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                //         BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                //         BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                //         PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                //         BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                //         ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,
                   }   
               
                   arrayNota.push(notas)
    
    
                } else if (
                            result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10 != undefined
                        )
        
                            { 
                                var notas = {
                                    
                                    Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                    DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                    tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                    CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                    NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                    CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                    NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                    CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                                    EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                    DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                                    NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                                    CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                                    cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                    CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                                    Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                                    ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                                    ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                                    CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.CST._text,
                                    BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vBC,
                                    PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.pICMS),
                                    ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vICMSOp,
                                    PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.pDif,
                                    ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vICMSDif,
                                    ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vICMS,
                                    BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vBCFCP,
                                    PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.pFCP,
                                    ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vFCP,
                                    ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.ModBCST,
                                    PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.pMVAST, 
                                    PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.pRedBCST, 
                                    BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vBCST,
                                    AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.pICMSST,
                                    ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vICMSST,
                                    valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vBCFCPST,
                                    PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.pFCPST,                           
                                    valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vFCPST,
                                    ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vICMSDeson,
                                    ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vBCSTRet, 
                                    AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.pST,
                                    ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vICMSSubstituto,
                                    ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vICMSSTRet,
                                    ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vBCFCPSTRet,
                                    PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.pFCPSTRet,
                                    valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vFCPSTRet,
                                    PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.pRedBCEfet,
                                    valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vBCEfet,
                                    aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.pICMSEfet,
                                    valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS10.vICMSEfet,
                                    valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                                    valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                                    valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                                    valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                                    CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                                    valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                                    CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                                    valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                                    // ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST,
                                    // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                                    // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                                    // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                                    // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                                    // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                                    // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                                    // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                                    // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                                    // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                                    // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                                    // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,
                            
                                }   
                            
                                
                                arrayNota.push(notas)
                
                
                            } else if (
                                        result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20 != undefined
                                    )
            
                                        { 
                                            var notas = {
                    
                                                Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                                                EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                                                NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                                                CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                                                cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                                                Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                                                ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                                                ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                                                CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.CST._text,
                                                BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vBC,
                                                PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.pICMS),
                                                ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vICMSOp,
                                                PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.pDif,
                                                ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vICMSDif,
                                                ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vICMS,
                                                BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vBCFCP,
                                                PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.pFCP,
                                                ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vFCP,
                                                ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.ModBCST,
                                                PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.pMVAST, 
                                                PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.pRedBCST, 
                                                BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vBCST,
                                                AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.pICMSST,
                                                ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vICMSST,
                                                valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vBCFCPST,
                                                PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.pFCPST,                           
                                                valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vFCPST,
                                                ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vICMSDeson,
                                                ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vBCSTRet, 
                                                AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.pST,
                                                ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vICMSSubstituto,
                                                ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vICMSSTRet,
                                                ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vBCFCPSTRet,
                                                PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.pFCPSTRet,
                                                valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vFCPSTRet,
                                                PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.pRedBCEfet,
                                                valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vBCEfet,
                                                aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.pICMSEfet,
                                                valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS20.vICMSEfet,
                                                valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                                                valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                                                valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                                                valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                                                CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                                                valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                                                CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                                                valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                                                // ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST._text,
                                                // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                                                // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                                                // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                                                // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                                                // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                                                // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                                                // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                                                // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                                                // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                                                // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,

                                            }   
                                        
                                            arrayNota.push(notas)
                            
                            
                                        } else if (
                                                    result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30 != undefined 
                                                )


                                                    { 
                                                        var notas = {
                            
                                                            Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                            DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                            tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                            CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                            NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                            CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                            NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                            CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                                                            EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                            DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                                                            NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                                                            CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                                                            cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                            CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                                                            Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                                                            ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                                                            ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                                                            CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.CST._text,
                                                            BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vBC,
                                                            PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.pICMS),
                                                            ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vICMSOp,
                                                            PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.pDif,
                                                            ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vICMSDif,
                                                            ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vICMS,
                                                            BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vBCFCP,
                                                            PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.pFCP,
                                                            ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vFCP,
                                                            ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.ModBCST,
                                                            PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.pMVAST, 
                                                            PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.pRedBCST, 
                                                            BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vBCST,
                                                            AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.pICMSST,
                                                            ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vICMSST,
                                                            valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vBCFCPST,
                                                            PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.pFCPST,                           
                                                            valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vFCPST,
                                                            ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vICMSDeson,
                                                            ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vBCSTRet, 
                                                            AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.pST,
                                                            ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vICMSSubstituto,
                                                            ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vICMSSTRet,
                                                            ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vBCFCPSTRet,
                                                            PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.pFCPSTRet,
                                                            valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vFCPSTRet,
                                                            PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.pRedBCEfet,
                                                            valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vBCEfet,
                                                            aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.pICMSEfet,
                                                            valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS30.vICMSEfet,
                                                            valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                                                            valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                                                            valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                                                            valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                                                            CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                                                            valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                                                            CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                                                            valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                                                            // ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST._text,
                                                            // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                                                            // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                                                            // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                                                            // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                                                            // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                            // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                                                            // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                                                            // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                                                            // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                                                            // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                                                            // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,

                                                    
                                                        }   
                                                    
                                                        arrayNota.push(notas)
                                        
                                        
                                                    } else if (
                                                                result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40 != undefined
                                                            )
                                                                    { 
                                                                        var notas = {

                                                                            Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                            DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                            tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                            CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                            NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                            CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                            NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                            CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                                                                            EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                            DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                                                                            NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                                                                            CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                                                                            cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                            CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                                                                            Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                                                                            ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                                                                            ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                                                                            CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.CST._text,
                                                                            BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vBC,
                                                                            PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.pICMS),
                                                                            ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vICMSOp,
                                                                            PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.pDif,
                                                                            ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vICMSDif,
                                                                            ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vICMS,
                                                                            BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vBCFCP,
                                                                            PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.pFCP,
                                                                            ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vFCP,
                                                                            ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.ModBCST,
                                                                            PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.pMVAST, 
                                                                            PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.pRedBCST, 
                                                                            BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vBCST,
                                                                            AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.pICMSST,
                                                                            ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vICMSST,
                                                                            valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vBCFCPST,
                                                                            PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.pFCPST,                           
                                                                            valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vFCPST,
                                                                            ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vICMSDeson,
                                                                            ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vBCSTRet, 
                                                                            AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.pST,
                                                                            ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vICMSSubstituto,
                                                                            ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vICMSSTRet,
                                                                            ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vBCFCPSTRet,
                                                                            PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.pFCPSTRet,
                                                                            valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vFCPSTRet,
                                                                            PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.pRedBCEfet,
                                                                            valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vBCEfet,
                                                                            aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.pICMSEfet,
                                                                            valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS40.vICMSEfet,
                                                                            valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                                                                            valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                                                                            valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                                                                            valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                                                                            CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                                                                            valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                                                                            CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                                                                            valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                                                                            // ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST._text,
                                                                            // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                                                                            // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                                                                            // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                            // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                                                                            // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                            // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                                                                            // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                                                                            // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                                                                            // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                                                                            // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                                                                            // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,
                                                                    
                                                                        }   
                                                                    
                                                                        arrayNota.push(notas)
                                                        
                                                        
                                                                    } else if (
                                                                                result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41 != undefined
                                                                             )
                                    
                                                                                    {
                                                                                        var notas = {
                                                    
                                                                                            Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                            DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                            tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                            CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                            NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                            CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                            NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                            CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                                                                                            EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                            DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                                                                                            NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                                                                                            CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                                                                                            cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                            CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                                                                                            Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                                                                                            ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                                                                                            ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                                                                                            CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.CST._text,
                                                                                            BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vBC,
                                                                                            PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.pICMS),
                                                                                            ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vICMSOp,
                                                                                            PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.pDif,
                                                                                            ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vICMSDif,
                                                                                            ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vICMS,
                                                                                            BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vBCFCP,
                                                                                            PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.pFCP,
                                                                                            ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vFCP,
                                                                                            ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.ModBCST,
                                                                                            PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.pMVAST, 
                                                                                            PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.pRedBCST, 
                                                                                            BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vBCST,
                                                                                            AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.pICMSST,
                                                                                            ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vICMSST,
                                                                                            valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vBCFCPST,
                                                                                            PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.pFCPST,                           
                                                                                            valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vFCPST,
                                                                                            ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vICMSDeson,
                                                                                            ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vBCSTRet, 
                                                                                            AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.pST,
                                                                                            ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vICMSSubstituto,
                                                                                            ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vICMSSTRet,
                                                                                            ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vBCFCPSTRet,
                                                                                            PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.pFCPSTRet,
                                                                                            valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vFCPSTRet,
                                                                                            PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.pRedBCEfet,
                                                                                            valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vBCEfet,
                                                                                            aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.pICMSEfet,
                                                                                            valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS41.vICMSEfet,
                                                                                            valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                                                                                            valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                                                                                            valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                                                                                            valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                                                                                            CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                                                                                            valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                                                                                            CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                                                                                            valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                                                                                            // ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST._text,
                                                                                            // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                            // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                                                                                            // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                            // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                            // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                            // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                            // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                                                                                            // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                            // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                            // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                                                                                            // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,

                                                                                        }

                                                                                    } else if (
                                                                                                result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50 != undefined
                                                                                            )
                        
                                                                                                { 
                                                                                                    var notas = {

                                                                                                        Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                        DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                        tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                        CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                        NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                        CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                        NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                        CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                                                                                                        EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                        DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                                                                                                        NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                                                                                                        CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                                                                                                        cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                        CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                                                                                                        Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                                                                                                        ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                                                                                                        ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                                                                                                        CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.CST._text,
                                                                                                        BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vBC,
                                                                                                        PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.pICMS),
                                                                                                        ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vICMSOp,
                                                                                                        PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.pDif,
                                                                                                        ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vICMSDif,
                                                                                                        ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vICMS,
                                                                                                        BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vBCFCP,
                                                                                                        PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.pFCP,
                                                                                                        ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vFCP,
                                                                                                        ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.ModBCST,
                                                                                                        PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.pMVAST, 
                                                                                                        PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.pRedBCST, 
                                                                                                        BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vBCST,
                                                                                                        AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.pICMSST,
                                                                                                        ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vICMSST,
                                                                                                        valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vBCFCPST,
                                                                                                        PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.pFCPST,                           
                                                                                                        valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vFCPST,
                                                                                                        ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vICMSDeson,
                                                                                                        ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vBCSTRet, 
                                                                                                        AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.pST,
                                                                                                        ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vICMSSubstituto,
                                                                                                        ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vICMSSTRet,
                                                                                                        ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vBCFCPSTRet,
                                                                                                        PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.pFCPSTRet,
                                                                                                        valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vFCPSTRet,
                                                                                                        PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.pRedBCEfet,
                                                                                                        valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vBCEfet,
                                                                                                        aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.pICMSEfet,
                                                                                                        valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS50.vICMSEfet,
                                                                                                        valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                                                                                                        valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                                                                                                        valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                                                                                                        valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                                                                                                        CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                                                                                                        valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                                                                                                        CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                                                                                                        valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                                                                                                        // ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST._text,
                                                                                                        // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                        // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                                                                                                        // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                        // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                        // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                        // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                        // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                        // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                        // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                        // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                        // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,
                                                                                                
                                                                                                    }  
                                                                                                
                                                                                        
                                                                                                    arrayNota.push(notas)
                                                                            
                                                                            
                                                                                                } else if  
                                                                                                        (
                                                                                                            result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51 != undefined
                                                                                                        )
                        
                                                                                                            { 
                                                                                                                var notas = {

                                                                                                                    Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                                    DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                                    tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                                    CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                                    NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                                    CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                                    NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                                    CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                                                                                                                    EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                                    DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                                                                                                                    NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                                                                                                                    CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                                                                                                                    cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                                    CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                                                                                                                    Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                                                                                                                    ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                                                                                                                    ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                                                                                                                    CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.CST._text,
                                                                                                                    BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vBC,
                                                                                                                    PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.pICMS),
                                                                                                                    ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vICMSOp,
                                                                                                                    PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.pDif,
                                                                                                                    ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vICMSDif,
                                                                                                                    ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vICMS,
                                                                                                                    BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vBCFCP,
                                                                                                                    PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.pFCP,
                                                                                                                    ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vFCP,
                                                                                                                    ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.ModBCST,
                                                                                                                    PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.pMVAST, 
                                                                                                                    PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.pRedBCST, 
                                                                                                                    BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vBCST,
                                                                                                                    AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.pICMSST,
                                                                                                                    ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vICMSST,
                                                                                                                    valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vBCFCPST,
                                                                                                                    PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.pFCPST,                           
                                                                                                                    valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vFCPST,
                                                                                                                    ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vICMSDeson,
                                                                                                                    ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vBCSTRet, 
                                                                                                                    AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.pST,
                                                                                                                    ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vICMSSubstituto,
                                                                                                                    ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vICMSSTRet,
                                                                                                                    ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vBCFCPSTRet,
                                                                                                                    PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.pFCPSTRet,
                                                                                                                    valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vFCPSTRet,
                                                                                                                    PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.pRedBCEfet,
                                                                                                                    valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vBCEfet,
                                                                                                                    aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.pICMSEfet,
                                                                                                                    valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS51.vICMSEfet,
                                                                                                                    valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                                                                                                                    valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                                                                                                                    valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                                                                                                                    valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                                                                                                                    CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                                                                                                                    valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                                                                                                                    CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                                                                                                                    valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                                                                                                                    // ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST._text,
                                                                                                                    // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                                    // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                                                                                                                    // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                                    // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                                    // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                                    // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                                    // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                                    // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                                    // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                                    // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                                    // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,
                                                                                                            
                                                                                                                }  
                                                                                                            
                                                                                                    
                                                                                                                arrayNota.push(notas)
                                                                                        
                                                                                        
                                                                                                            } else if
                                                                                                                        (
                                                                                                                            result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60 != undefined
                                                                                                                        )
                                                    
                                                                                                                            { 
                                                                                                                                var notas = {

                                                                                                                                    Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                                                    DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                                                    tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                                                    CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                                                    NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                                                    CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                                                    NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                                                    CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                                                                                                                                    EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                                                    DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                                                                                                                                    NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                                                                                                                                    CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                                                                                                                                    cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                                                    CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                                                                                                                                    Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                                                                                                                                    ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                                                                                                                                    ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                                                                                                                                    CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.CST._text,
                                                                                                                                    BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vBC,
                                                                                                                                    PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.pICMS),
                                                                                                                                    ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vICMSOp,
                                                                                                                                    PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.pDif,
                                                                                                                                    ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vICMSDif,
                                                                                                                                    ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vICMS,
                                                                                                                                    BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vBCFCP,
                                                                                                                                    PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.pFCP,
                                                                                                                                    ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vFCP,
                                                                                                                                    ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.ModBCST,
                                                                                                                                    PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.pMVAST, 
                                                                                                                                    PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.pRedBCST, 
                                                                                                                                    BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vBCST,
                                                                                                                                    AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.pICMSST,
                                                                                                                                    ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vICMSST,
                                                                                                                                    valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vBCFCPST,
                                                                                                                                    PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.pFCPST,                           
                                                                                                                                    valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vFCPST,
                                                                                                                                    ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vICMSDeson,
                                                                                                                                    ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vBCSTRet, 
                                                                                                                                    AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.pST,
                                                                                                                                    ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vICMSSubstituto,
                                                                                                                                    ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vICMSSTRet,
                                                                                                                                    ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vBCFCPSTRet,
                                                                                                                                    PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.pFCPSTRet,
                                                                                                                                    valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vFCPSTRet,
                                                                                                                                    PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.pRedBCEfet,
                                                                                                                                    valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vBCEfet,
                                                                                                                                    aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.pICMSEfet,
                                                                                                                                    valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS60.vICMSEfet,
                                                                                                                                    valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                                                                                                                                    valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                                                                                                                                    valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                                                                                                                                    valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                                                                                                                                    CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                                                                                                                                    valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                                                                                                                                    CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                                                                                                                                    valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                                                                                                                                    // ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST._text,
                                                                                                                                    // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                                                    // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                                                                                                                                    // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                                                    // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                                                    // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                                                    // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                                                    // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                                                    // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                                                    // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                                                    // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                                                    // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,
                                                                                                                            
                                                                                                                                }   
                                                                                                                            
                                                                                                                                arrayNota.push(notas)
                                                                                                                    
                                                                                                                    
                                                                                                                            } else if
                                                                                                                                        (
                                                                                                                                            result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70 != undefined
                                                                                                                                        )
                                                        
                                                                                                                                            { 
                                                                                                                                                var notas = {
                                                                                                    
                                                                                                                                                    Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                                                                    DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                                                                    tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                                                                    CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                                                                    NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                                                                    CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                                                                    NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                                                                    CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                                                                                                                                                    EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                                                                    DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                                                                                                                                                    NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                                                                                                                                                    CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                                                                                                                                                    cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                                                                    CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                                                                                                                                                    Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                                                                                                                                                    ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                                                                                                                                                    ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                                                                                                                                                    CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.CST._text,
                                                                                                                                                    BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vBC,
                                                                                                                                                    PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.pICMS),
                                                                                                                                                    ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vICMSOp,
                                                                                                                                                    PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.pDif,
                                                                                                                                                    ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vICMSDif,
                                                                                                                                                    ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vICMS,
                                                                                                                                                    BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vBCFCP,
                                                                                                                                                    PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.pFCP,
                                                                                                                                                    ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vFCP,
                                                                                                                                                    ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.ModBCST,
                                                                                                                                                    PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.pMVAST, 
                                                                                                                                                    PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.pRedBCST, 
                                                                                                                                                    BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vBCST,
                                                                                                                                                    AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.pICMSST,
                                                                                                                                                    ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vICMSST,
                                                                                                                                                    valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vBCFCPST,
                                                                                                                                                    PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.pFCPST,                           
                                                                                                                                                    valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vFCPST,
                                                                                                                                                    ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vICMSDeson,
                                                                                                                                                    ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vBCSTRet, 
                                                                                                                                                    AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.pST,
                                                                                                                                                    ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vICMSSubstituto,
                                                                                                                                                    ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vICMSSTRet,
                                                                                                                                                    ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vBCFCPSTRet,
                                                                                                                                                    PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.pFCPSTRet,
                                                                                                                                                    valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vFCPSTRet,
                                                                                                                                                    PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.pRedBCEfet,
                                                                                                                                                    valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vBCEfet,
                                                                                                                                                    aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.pICMSEfet,
                                                                                                                                                    valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS70.vICMSEfet,
                                                                                                                                                    valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                                                                                                                                                    valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                                                                                                                                                    valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                                                                                                                                                    valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                                                                                                                                                    CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                                                                                                                                                    valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                                                                                                                                                    CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                                                                                                                                                    valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                                                                                                                                                    // ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST._text,
                                                                                                                                                    // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                                                                    // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                                                                                                                                                    // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                                                                    // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                                                                    // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                                                                    // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                                                                    // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                                                                    // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                                                                    // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                                                                    // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                                                                    // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,

                                                                                                                                            
                                                                                                                                                }
                                                                                                                                                arrayNota.push(notas)
                                                                                                                                
                                                                                                                                
                                                                                                                                            } else if
                                                                                                                                                    (
                                                                                                                                                        result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80 != undefined
                                                                                                                                                        )
                                                                
                                                                                                                                                                { 
                                                                                                                                                                    var notas = {
                                                                                                                    
                                                                                                                                                                        Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                                                                                        DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                                                                                        tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                                                                                        CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                                                                                        NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                                                                                        CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                                                                                        NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                                                                                        CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                                                                                                                                                                        EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                                                                                        DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                                                                                                                                                                        NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                                                                                                                                                                        CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                                                                                                                                                                        cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                                                                                        CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                                                                                                                                                                        Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                                                                                                                                                                        ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                                                                                                                                                                        ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                                                                                                                                                                        CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.CST._text,
                                                                                                                                                                        BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vBC,
                                                                                                                                                                        PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.pICMS),
                                                                                                                                                                        ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vICMSOp,
                                                                                                                                                                        PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.pDif,
                                                                                                                                                                        ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vICMSDif,
                                                                                                                                                                        ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vICMS,
                                                                                                                                                                        BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vBCFCP,
                                                                                                                                                                        PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.pFCP,
                                                                                                                                                                        ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vFCP,
                                                                                                                                                                        ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.ModBCST,
                                                                                                                                                                        PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.pMVAST, 
                                                                                                                                                                        PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.pRedBCST, 
                                                                                                                                                                        BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vBCST,
                                                                                                                                                                        AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.pICMSST,
                                                                                                                                                                        ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vICMSST,
                                                                                                                                                                        valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vBCFCPST,
                                                                                                                                                                        PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.pFCPST,                           
                                                                                                                                                                        valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vFCPST,
                                                                                                                                                                        ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vICMSDeson,
                                                                                                                                                                        ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vBCSTRet, 
                                                                                                                                                                        AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.pST,
                                                                                                                                                                        ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vICMSSubstituto,
                                                                                                                                                                        ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vICMSSTRet,
                                                                                                                                                                        ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vBCFCPSTRet,
                                                                                                                                                                        PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.pFCPSTRet,
                                                                                                                                                                        valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vFCPSTRet,
                                                                                                                                                                        PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.pRedBCEfet,
                                                                                                                                                                        valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vBCEfet,
                                                                                                                                                                        aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.pICMSEfet,
                                                                                                                                                                        valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS80.vICMSEfet,
                                                                                                                                                                        valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                                                                                                                                                                        valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                                                                                                                                                                        valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                                                                                                                                                                        valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                                                                                                                                                                        CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                                                                                                                                                                        valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                                                                                                                                                                        CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                                                                                                                                                                        valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                                                                                                                                                                        // ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST._text,
                                                                                                                                                                        // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                                                                                        // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                                                                                                                                                                        // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                                                                                        // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                                                                                        // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                                                                                        // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                                                                                        // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                                                                                        // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                                                                                        // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                                                                                        // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                                                                                        // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,
                                                                                                                                                                
                                                                                                                                                                    }   
                                                                                                                                                                
                                                                                                                                                                    arrayNota.push(notas)
                                                                                                                                                    
                                                                                                                                                    
                                                                                                                                                                } else if
                                                                                                                                                                        (
                                                                                                                                                                            result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90 != undefined 
                                                                                                                                                                            )
                                                                
                                                                                                                                                                                { 
                                                                                                                                                                                    var notas = {
                                                                                                                                
                                                                                                                                                                                        Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                                                                                                        DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                                                                                                        tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                                                                                                        CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                                                                                                        NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                                                                                                        CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                                                                                                        NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                                                                                                        CodigoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.cProd,
                                                                                                                                                                                        EAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                                                                                                        DescriçaoProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.xProd,
                                                                                                                                                                                        NCM:  result.nfeProc.NFe.infNFe.det[idet].prod.NCM,
                                                                                                                                                                                        CEST:  result.nfeProc.NFe.infNFe.det[idet].prod.CEST,
                                                                                                                                                                                        cEAN:  result.nfeProc.NFe.infNFe.det[idet].prod.cEAN,
                                                                                                                                                                                        CFOP:  result.nfeProc.NFe.infNFe.det[idet].prod.CFOP,
                                                                                                                                                                                        Quantidade:  result.nfeProc.NFe.infNFe.det[idet].prod.qCom,
                                                                                                                                                                                        ValorUnitario:  result.nfeProc.NFe.infNFe.det[idet].prod.vUnCom,
                                                                                                                                                                                        ValorProduto:  result.nfeProc.NFe.infNFe.det[idet].prod.vProd,
                                                                                                                                                                                        CST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.CST._text,
                                                                                                                                                                                        BaseICMS:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vBC,
                                                                                                                                                                                        PorcentICMS: (result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.pICMS),
                                                                                                                                                                                        ValorICMSOper: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vICMSOp,
                                                                                                                                                                                        PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.pDif,
                                                                                                                                                                                        ValorICMSDiferido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vICMSDif,
                                                                                                                                                                                        ValorICMS: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vICMS,
                                                                                                                                                                                        BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vBCFCP,
                                                                                                                                                                                        PorcentFCP: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.pFCP,
                                                                                                                                                                                        ValorFECP:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vFCP,
                                                                                                                                                                                        ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.ModBCST,
                                                                                                                                                                                        PorcentMVAST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.pMVAST, 
                                                                                                                                                                                        PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.pRedBCST, 
                                                                                                                                                                                        BaseICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vBCST,
                                                                                                                                                                                        AlíquotaICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.pICMSST,
                                                                                                                                                                                        ValorICMSST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vICMSST,
                                                                                                                                                                                        valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vBCFCPST,
                                                                                                                                                                                        PorcentFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.pFCPST,                           
                                                                                                                                                                                        valorFeCPST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vFCPST,
                                                                                                                                                                                        ValorICMSDeson: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vICMSDeson,
                                                                                                                                                                                        ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vBCSTRet, 
                                                                                                                                                                                        AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.pST,
                                                                                                                                                                                        ICMSPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vICMSSubstituto,
                                                                                                                                                                                        ValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vICMSSTRet,
                                                                                                                                                                                        ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vBCFCPSTRet,
                                                                                                                                                                                        PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.pFCPSTRet,
                                                                                                                                                                                        valorFCPSTRetido: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vFCPSTRet,
                                                                                                                                                                                        PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.pRedBCEfet,
                                                                                                                                                                                        valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vBCEfet,
                                                                                                                                                                                        aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.pICMSEfet,
                                                                                                                                                                                        valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMS90.vICMSEfet,
                                                                                                                                                                                        valorFrete: result.nfeProc.NFe.infNFe.det[idet].prod.vFrete,
                                                                                                                                                                                        valorSeguro: result.nfeProc.NFe.infNFe.det[idet].prod.vSeg,
                                                                                                                                                                                        valorDesconto: result.nfeProc.NFe.infNFe.det[idet].prod.vDesc,
                                                                                                                                                                                        valorOutros: result.nfeProc.NFe.infNFe.det[idet].prod.vOutro,
                                                                                                                                                                                        CSTPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.CST,
                                                                                                                                                                                        valorPIS: result.nfeProc.NFe.infNFe.det[idet].imposto.PIS.vPIS,
                                                                                                                                                                                        CSTCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.CST,
                                                                                                                                                                                        valorCOFINS: result.nfeProc.NFe.infNFe.det[idet].imposto.COFINS.vCOFINS,
                                                                                                                                                                                        // ICMSSTCST: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.CST._text,
                                                                                                                                                                                        // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                                                                                                        // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pST,
                                                                                                                                                                                        // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                                                                                                        // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                                                                                                        // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                                                                                                        // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                                                                                                        // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                                                                                                        // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                                                                                                        // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                                                                                                        // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                                                                                                        // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det[idet].imposto.ICMS.ICMSST.vICMSEfet,
                                                                                                                                                                                                                                                        
                                                                                                                                                                                    }   
                                                                                                                                                                                
                                                                                                                                                                                    arrayNota.push(notas)
                                                                                                                                                                    
                                                                                                                                                                    
                                                                                                                                                                                }
    




        }

    } else {

        if (
            result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00 != undefined
            )

            { 
                var notas = {

                    Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                    DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                    tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                    CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                    NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                    CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                    NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                    CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                    EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                    DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                    NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                    CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                    cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                    CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                    Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                    ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                    ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                    CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.CST._text,
                    BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vBC,
                    PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.pICMS),
                    ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vICMSOp,
                    PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.pDif,
                    ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vICMSDif,
                    ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vICMS,
                    BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vBCFCP,
                    PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.pFCP,
                    ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vFCP,
                    ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.ModBCST,
                    PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.pMVAST, 
                    PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.pRedBCST, 
                    BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vBCST,
                    AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.pICMSST,
                    ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vICMSST,
                    valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vBCFCPST,
                    PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.pFCPST,                           
                    valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vFCPST,
                    ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vICMSDeson,
                    ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vBCSTRet, 
                    AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.pST,
                    ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vICMSSubstituto,
                    ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vICMSSTRet,
                    ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vBCFCPSTRet,
                    PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.pFCPSTRet,
                    valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vFCPSTRet,
                    PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.pRedBCEfet,
                    valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vBCEfet,
                    aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.pICMSEfet,
                    valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS00.vICMSEfet,
                    valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                    valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                    valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                    valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                    CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                    valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                    CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                    valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                    // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                    // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                    // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                    // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                    // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                    // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                    // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                    // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                    // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                    // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                    // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                    // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
           
               }   
           
               arrayNota.push(notas)


            } else if   (
                        result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10 != undefined
                        )
    
                            { 
                                var notas = {

                                    Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                    DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                    tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                    CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                    NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                    CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                    NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                    CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                                    EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                    DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                                    NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                                    CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                                    cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                    CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                                    Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                                    ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                                    ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                                    CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.CST._text,
                                    BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vBC,
                                    PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.pICMS),
                                    ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vICMSOp,
                                    PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.pDif,
                                    ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vICMSDif,
                                    ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vICMS,
                                    BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vBCFCP,
                                    PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.pFCP,
                                    ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vFCP,
                                    ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.ModBCST,
                                    PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.pMVAST, 
                                    PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.pRedBCST, 
                                    BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vBCST,
                                    AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.pICMSST,
                                    ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vICMSST,
                                    valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vBCFCPST,
                                    PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.pFCPST,                           
                                    valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vFCPST,
                                    ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vICMSDeson,
                                    ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vBCSTRet, 
                                    AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.pST,
                                    ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vICMSSubstituto,
                                    ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vICMSSTRet,
                                    ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vBCFCPSTRet,
                                    PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.pFCPSTRet,
                                    valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vFCPSTRet,
                                    PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.pRedBCEfet,
                                    valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vBCEfet,
                                    aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.pICMSEfet,
                                    valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS10.vICMSEfet,
                                    valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                                    valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                                    valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                                    valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                                    CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                                    valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                                    CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                                    valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                                    // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                                    // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                                    // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                                    // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                                    // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                                    // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                                    // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                                    // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                                    // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                                    // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                                    // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                                    // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
                  
                                }   
                  
                      
                                arrayNota.push(notas)
    
    
                            } else if   (
                                        result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20 != undefined
                                        )
        
                                            { 
                                                 var notas = {

                                                    Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                    DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                    tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                    CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                    NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                    CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                    NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                    CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                                                    EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                    DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                                                    NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                                                    CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                                                    cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                    CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                                                    Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                                                    ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                                                    ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                                                    CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.CST._text,
                                                    BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vBC,
                                                    PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.pICMS),
                                                    ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vICMSOp,
                                                    PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.pDif,
                                                    ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vICMSDif,
                                                    ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vICMS,
                                                    BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vBCFCP,
                                                    PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.pFCP,
                                                    ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vFCP,
                                                    ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.ModBCST,
                                                    PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.pMVAST, 
                                                    PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.pRedBCST, 
                                                    BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vBCST,
                                                    AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.pICMSST,
                                                    ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vICMSST,
                                                    valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vBCFCPST,
                                                    PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.pFCPST,                           
                                                    valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vFCPST,
                                                    ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vICMSDeson,
                                                    ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vBCSTRet, 
                                                    AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.pST,
                                                    ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vICMSSubstituto,
                                                    ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vICMSSTRet,
                                                    ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vBCFCPSTRet,
                                                    PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.pFCPSTRet,
                                                    valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vFCPSTRet,
                                                    PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.pRedBCEfet,
                                                    valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vBCEfet,
                                                    aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.pICMSEfet,
                                                    valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS20.vICMSEfet,
                                                    valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                                                    valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                                                    valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                                                    valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                                                    CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                                                    valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                                                    CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                                                    valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                                                    // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                                                    // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                                                    // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                                                    // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                                                    // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                                                    // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                    // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                                                    // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                                                    // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                                                    // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                                                    // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                                                    // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
                                        
                                                }   
                                        
                                                arrayNota.push(notas)
        
        
                                            } else if (
                                                        result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30 != undefined
                                                        )
            
                                                            { 
                                                    var notas = {

                                                        Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                        DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                        tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                        CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                        NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                        CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                        NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                        CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                                                        EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                        DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                                                        NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                                                        CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                                                        cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                        CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                                                        Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                                                        ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                                                        ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                                                        CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.CST._text,
                                                        BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vBC,
                                                        PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.pICMS),
                                                        ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vICMSOp,
                                                        PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.pDif,
                                                        ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vICMSDif,
                                                        ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vICMS,
                                                        BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vBCFCP,
                                                        PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.pFCP,
                                                        ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vFCP,
                                                        ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.ModBCST,
                                                        PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.pMVAST, 
                                                        PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.pRedBCST, 
                                                        BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vBCST,
                                                        AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.pICMSST,
                                                        ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vICMSST,
                                                        valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vBCFCPST,
                                                        PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.pFCPST,                           
                                                        valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vFCPST,
                                                        ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vICMSDeson,
                                                        ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vBCSTRet, 
                                                        AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.pST,
                                                        ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vICMSSubstituto,
                                                        ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vICMSSTRet,
                                                        ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vBCFCPSTRet,
                                                        PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.pFCPSTRet,
                                                        valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vFCPSTRet,
                                                        PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.pRedBCEfet,
                                                        valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vBCEfet,
                                                        aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.pICMSEfet,
                                                        valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS30.vICMSEfet,
                                                        valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                                                        valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                                                        valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                                                        valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                                                        CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                                                        valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                                                        CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                                                        valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                                                        // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                                                        // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                                                        // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                                                        // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                                                        // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                                                        // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                        // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                                                        // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                                                        // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                                                        // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                                                        // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                                                        // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
                                    
                                                    }   
                                    
                                                    arrayNota.push(notas)
            
            
                                                } else if (
                                                            result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40 != undefined
                                                            )
                
                                                                { 
                                                                    var notas = {

                                                                        Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                        DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                        tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                        CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                        NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                        CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                        NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                        CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                                                                        EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                        DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                                                                        NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                                                                        CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                                                                        cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                        CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                                                                        Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                                                                        ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                                                                        ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                                                                        CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.CST._text,
                                                                        BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vBC,
                                                                        PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.pICMS),
                                                                        ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vICMSOp,
                                                                        PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.pDif,
                                                                        ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vICMSDif,
                                                                        ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vICMS,
                                                                        BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vBCFCP,
                                                                        PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.pFCP,
                                                                        ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vFCP,
                                                                        ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.ModBCST,
                                                                        PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.pMVAST, 
                                                                        PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.pRedBCST, 
                                                                        BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vBCST,
                                                                        AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.pICMSST,
                                                                        ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vICMSST,
                                                                        valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vBCFCPST,
                                                                        PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.pFCPST,                           
                                                                        valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vFCPST,
                                                                        ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vICMSDeson,
                                                                        ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vBCSTRet, 
                                                                        AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.pST,
                                                                        ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vICMSSubstituto,
                                                                        ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vICMSSTRet,
                                                                        ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vBCFCPSTRet,
                                                                        PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.pFCPSTRet,
                                                                        valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vFCPSTRet,
                                                                        PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.pRedBCEfet,
                                                                        valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vBCEfet,
                                                                        aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.pICMSEfet,
                                                                        valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS40.vICMSEfet,
                                                                        valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                                                                        valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                                                                        valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                                                                        valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                                                                        CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                                                                        valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                                                                        CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                                                                        valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                                                                        // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                                                                        // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                                                                        // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                                                                        // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                        // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                                                                        // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                        // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                                                                        // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                                                                        // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                                                                        // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                                                                        // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                                                                        // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
                                        
                                                                    }   
                                        
                                                                    arrayNota.push(notas)
                
                
                                                                 } else if 
                                                                            (
                                                                                result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS41 != undefined
                                                                            ) 
                                                                                {

                                                                                    var notas = {

                                                                                        Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                        DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                        tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                        CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                        NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                        CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                        NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                        CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                                                                                        EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                        DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                                                                                        NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                                                                                        CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                                                                                        cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                        CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                                                                                        Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                                                                                        ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                                                                                        ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                                                                                        CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.CST._text,
                                                                                        BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBC,
                                                                                        PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pICMS),
                                                                                        ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSOp,
                                                                                        PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pDif,
                                                                                        ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSDif,
                                                                                        ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMS,
                                                                                        BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCFCP,
                                                                                        PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pFCP,
                                                                                        ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vFCP,
                                                                                        ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.ModBCST,
                                                                                        PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pMVAST, 
                                                                                        PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pRedBCST, 
                                                                                        BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCST,
                                                                                        AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pICMSST,
                                                                                        ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSST,
                                                                                        valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCFCPST,
                                                                                        PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pFCPST,                           
                                                                                        valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vFCPST,
                                                                                        ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSDeson,
                                                                                        ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCSTRet, 
                                                                                        AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pST,
                                                                                        ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSSubstituto,
                                                                                        ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSSTRet,
                                                                                        ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCFCPSTRet,
                                                                                        PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pFCPSTRet,
                                                                                        valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vFCPSTRet,
                                                                                        PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pRedBCEfet,
                                                                                        valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCEfet,
                                                                                        aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pICMSEfet,
                                                                                        valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSEfet,
                                                                                        valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                                                                                        valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                                                                                        valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                                                                                        valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                                                                                        CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                                                                                        valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                                                                                        CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                                                                                        valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                                                                                        // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                                                                                        // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                        // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                                                                                        // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                        // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                        // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                        // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                        // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                                                                                        // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                        // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                        // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                                                                                        // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
                                            
                                                                                    }

                                                                                } else if (
                                                                                            result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50 != undefined
                                                                                            )
                        
                                                                                                 { 
                                                                                                    var notas = {

                                                                                                        Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                        DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                        tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                        CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                        NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                        CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                        NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                        CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                                                                                                        EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                        DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                                                                                                        NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                                                                                                        CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                                                                                                        cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                        CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                                                                                                        Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                                                                                                        ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                                                                                                        ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                                                                                                        CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.CST._text,
                                                                                                        BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBC,
                                                                                                        PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pICMS),
                                                                                                        ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSOp,
                                                                                                        PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pDif,
                                                                                                        ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSDif,
                                                                                                        ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMS,
                                                                                                        BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCFCP,
                                                                                                        PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pFCP,
                                                                                                        ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vFCP,
                                                                                                        ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.ModBCST,
                                                                                                        PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pMVAST, 
                                                                                                        PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pRedBCST, 
                                                                                                        BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCST,
                                                                                                        AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pICMSST,
                                                                                                        ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSST,
                                                                                                        valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCFCPST,
                                                                                                        PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pFCPST,                           
                                                                                                        valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vFCPST,
                                                                                                        ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSDeson,
                                                                                                        ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCSTRet, 
                                                                                                        AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pST,
                                                                                                        ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSSubstituto,
                                                                                                        ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSSTRet,
                                                                                                        ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCFCPSTRet,
                                                                                                        PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pFCPSTRet,
                                                                                                        valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vFCPSTRet,
                                                                                                        PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pRedBCEfet,
                                                                                                        valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vBCEfet,
                                                                                                        aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.pICMSEfet,
                                                                                                        valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS50.vICMSEfet,
                                                                                                        valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                                                                                                        valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                                                                                                        valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                                                                                                        valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                                                                                                        CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                                                                                                        valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                                                                                                        CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                                                                                                        valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                                                                                                        // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                                                                                                        // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                        // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                                                                                                        // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                        // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                        // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                        // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                        // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                        // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                        // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                        // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                        // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
                                                            
                                                                                                    }   
                                                            
                                                                                                    arrayNota.push(notas)
                                                
                        
                                                                                                 } else if (
                                                                                                    result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51 != undefined
                                                                                                    )
                                
                                                                                                         { 
                                                                                                            var notas = {
        
                                                                                                                Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                                DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                                tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                                CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                                NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                                CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                                NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                                CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                                                                                                                EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                                DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                                                                                                                NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                                                                                                                CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                                                                                                                cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                                CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                                                                                                                Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                                                                                                                ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                                                                                                                ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                                                                                                                CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.CST._text,
                                                                                                                BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vBC,
                                                                                                                PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.pICMS),
                                                                                                                ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vICMSOp,
                                                                                                                PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.pDif,
                                                                                                                ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vICMSDif,
                                                                                                                ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vICMS,
                                                                                                                BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vBCFCP,
                                                                                                                PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.pFCP,
                                                                                                                ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vFCP,
                                                                                                                ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.ModBCST,
                                                                                                                PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.pMVAST, 
                                                                                                                PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.pRedBCST, 
                                                                                                                BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vBCST,
                                                                                                                AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.pICMSST,
                                                                                                                ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vICMSST,
                                                                                                                valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vBCFCPST,
                                                                                                                PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.pFCPST,                           
                                                                                                                valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vFCPST,
                                                                                                                ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vICMSDeson,
                                                                                                                ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vBCSTRet, 
                                                                                                                AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.pST,
                                                                                                                ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vICMSSubstituto,
                                                                                                                ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vICMSSTRet,
                                                                                                                ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vBCFCPSTRet,
                                                                                                                PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.pFCPSTRet,
                                                                                                                valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vFCPSTRet,
                                                                                                                PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.pRedBCEfet,
                                                                                                                valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vBCEfet,
                                                                                                                aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.pICMSEfet,
                                                                                                                valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS51.vICMSEfet,
                                                                                                                valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                                                                                                                valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                                                                                                                valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                                                                                                                valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                                                                                                                CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                                                                                                                valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                                                                                                                CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                                                                                                                valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                                                                                                                // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                                                                                                                // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                                // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                                                                                                                // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                                // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                                // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                                // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                                // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                                // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                                // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                                // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                                // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
                                                                    
                                                                                                            }   
                                                                    
                                                                                                            arrayNota.push(notas)
                                                        
                                
                                                                                                         } else if (
                                                                                                                    result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60 != undefined
                                                                                                                    )
                            
                                                                                                                        { 
                                                                                                                            var notas = {

                                                                                                                                    Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                                                    DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                                                    tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                                                    CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                                                    NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                                                    CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                                                    NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                                                    CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                                                                                                                                    EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                                                    DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                                                                                                                                    NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                                                                                                                                    CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                                                                                                                                    cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                                                    CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                                                                                                                                    Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                                                                                                                                    ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                                                                                                                                    ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                                                                                                                                    CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.CST._text,
                                                                                                                                    BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vBC,
                                                                                                                                    PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.pICMS),
                                                                                                                                    ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vICMSOp,
                                                                                                                                    PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.pDif,
                                                                                                                                    ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vICMSDif,
                                                                                                                                    ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vICMS,
                                                                                                                                    BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vBCFCP,
                                                                                                                                    PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.pFCP,
                                                                                                                                    ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vFCP,
                                                                                                                                    ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.ModBCST,
                                                                                                                                    PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.pMVAST, 
                                                                                                                                    PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.pRedBCST, 
                                                                                                                                    BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vBCST,
                                                                                                                                    AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.pICMSST,
                                                                                                                                    ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vICMSST,
                                                                                                                                    valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vBCFCPST,
                                                                                                                                    PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.pFCPST,                           
                                                                                                                                    valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vFCPST,
                                                                                                                                    ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vICMSDeson,
                                                                                                                                    ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vBCSTRet, 
                                                                                                                                    AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.pST,
                                                                                                                                    ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vICMSSubstituto,
                                                                                                                                    ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vICMSSTRet,
                                                                                                                                    ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vBCFCPSTRet,
                                                                                                                                    PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.pFCPSTRet,
                                                                                                                                    valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vFCPSTRet,
                                                                                                                                    PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.pRedBCEfet,
                                                                                                                                    valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vBCEfet,
                                                                                                                                    aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.pICMSEfet,
                                                                                                                                    valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS60.vICMSEfet,
                                                                                                                                    valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                                                                                                                                    valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                                                                                                                                    valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                                                                                                                                    valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                                                                                                                                    CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                                                                                                                                    valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                                                                                                                                    CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                                                                                                                                    valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                                                                                                                                    // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                                                                                                                                    // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                                                    // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                                                                                                                                    // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                                                    // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                                                    // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                                                    // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                                                    // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                                                    // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                                                    // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                                                    // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                                                    // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
                                                                            
                                                                                                                                }   
                                                                            
                                                                                                                                arrayNota.push(notas)
                                                    
                            
                                                                                                                            } else if (
                                                                                                                                        result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70 != undefined
                                                                                                                                        )
                                
                                                                                                                                            { 
                                                                                                                                                var notas = {

                                                                                                                                                    Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                                                                    DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                                                                    tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                                                                    CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                                                                    NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                                                                    CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                                                                    NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                                                                    CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                                                                                                                                                    EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                                                                    DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                                                                                                                                                    NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                                                                                                                                                    CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                                                                                                                                                    cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                                                                    CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                                                                                                                                                    Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                                                                                                                                                    ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                                                                                                                                                    ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                                                                                                                                                    CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.CST._text,
                                                                                                                                                    BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vBC,
                                                                                                                                                    PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.pICMS),
                                                                                                                                                    ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vICMSOp,
                                                                                                                                                    PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.pDif,
                                                                                                                                                    ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vICMSDif,
                                                                                                                                                    ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vICMS,
                                                                                                                                                    BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vBCFCP,
                                                                                                                                                    PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.pFCP,
                                                                                                                                                    ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vFCP,
                                                                                                                                                    ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.ModBCST,
                                                                                                                                                    PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.pMVAST, 
                                                                                                                                                    PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.pRedBCST, 
                                                                                                                                                    BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vBCST,
                                                                                                                                                    AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.pICMSST,
                                                                                                                                                    ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vICMSST,
                                                                                                                                                    valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vBCFCPST,
                                                                                                                                                    PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.pFCPST,                           
                                                                                                                                                    valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vFCPST,
                                                                                                                                                    ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vICMSDeson,
                                                                                                                                                    ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vBCSTRet, 
                                                                                                                                                    AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.pST,
                                                                                                                                                    ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vICMSSubstituto,
                                                                                                                                                    ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vICMSSTRet,
                                                                                                                                                    ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vBCFCPSTRet,
                                                                                                                                                    PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.pFCPSTRet,
                                                                                                                                                    valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vFCPSTRet,
                                                                                                                                                    PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.pRedBCEfet,
                                                                                                                                                    valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vBCEfet,
                                                                                                                                                    aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.pICMSEfet,
                                                                                                                                                    valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS70.vICMSEfet,
                                                                                                                                                    valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                                                                                                                                                    valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                                                                                                                                                    valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                                                                                                                                                    valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                                                                                                                                                    CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                                                                                                                                                    valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                                                                                                                                                    CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                                                                                                                                                    valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                                                                                                                                                    // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                                                                                                                                                    // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                                                                    // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                                                                                                                                                    // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                                                                    // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                                                                    // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                                                                    // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                                                                    // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                                                                    // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                                                                    // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                                                                    // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                                                                    // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
                                                                                
                                                                                                                                                }   
                                                                                
                                                
                                                                                                                                                arrayNota.push(notas)
                                                                    
                                
                                                                                                                                            } else if (
                                                                                                                                                        result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80 != undefined
                                                                                                                                                        )
                                    
                                                                                                                                                            { 
                                                                                                                                                                var notas = {

                                                                                                                                                                    Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                                                                                    DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                                                                                    tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                                                                                    CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                                                                                    NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                                                                                    CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                                                                                    NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                                                                                    CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                                                                                                                                                                    EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                                                                                    DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                                                                                                                                                                    NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                                                                                                                                                                    CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                                                                                                                                                                    cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                                                                                    CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                                                                                                                                                                    Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                                                                                                                                                                    ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                                                                                                                                                                    ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                                                                                                                                                                    CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.CST._text,
                                                                                                                                                                    BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vBC,
                                                                                                                                                                    PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.pICMS),
                                                                                                                                                                    ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vICMSOp,
                                                                                                                                                                    PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.pDif,
                                                                                                                                                                    ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vICMSDif,
                                                                                                                                                                    ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vICMS,
                                                                                                                                                                    BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vBCFCP,
                                                                                                                                                                    PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.pFCP,
                                                                                                                                                                    ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vFCP,
                                                                                                                                                                    ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.ModBCST,
                                                                                                                                                                    PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.pMVAST, 
                                                                                                                                                                    PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.pRedBCST, 
                                                                                                                                                                    BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vBCST,
                                                                                                                                                                    AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.pICMSST,
                                                                                                                                                                    ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vICMSST,
                                                                                                                                                                    valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vBCFCPST,
                                                                                                                                                                    PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.pFCPST,                           
                                                                                                                                                                    valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vFCPST,
                                                                                                                                                                    ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vICMSDeson,
                                                                                                                                                                    ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vBCSTRet, 
                                                                                                                                                                    AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.pST,
                                                                                                                                                                    ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vICMSSubstituto,
                                                                                                                                                                    ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vICMSSTRet,
                                                                                                                                                                    ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vBCFCPSTRet,
                                                                                                                                                                    PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.pFCPSTRet,
                                                                                                                                                                    valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vFCPSTRet,
                                                                                                                                                                    PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.pRedBCEfet,
                                                                                                                                                                    valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vBCEfet,
                                                                                                                                                                    aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.pICMSEfet,
                                                                                                                                                                    valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS80.vICMSEfet,
                                                                                                                                                                    valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                                                                                                                                                                    valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                                                                                                                                                                    valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                                                                                                                                                                    valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                                                                                                                                                                    CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                                                                                                                                                                    valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                                                                                                                                                                    CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                                                                                                                                                                    valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                                                                                                                                                                    // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                                                                                                                                                                    // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                                                                                    // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                                                                                                                                                                    // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                                                                                    // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                                                                                    // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                                                                                    // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                                                                                    // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                                                                                    // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                                                                                    // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                                                                                    // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                                                                                    // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
                                                                                    
                                                                                                                                                                }   
                                                                                                                                                            
                                                                                                                                                                arrayNota.push(notas)
                                                                        
                                    
                                                                                                                                                            } else if (
                                                                                                                                                                        result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90 != undefined 
                                                                                                                                                                        )
                                        
                                                                                                                                                                            { 
                                                                                                                                                                                var notas = {

                                                                                                                                                                                    Numero: result.nfeProc.NFe.infNFe.ide.nNF,
                                                                                                                                                                                    DataEmissao: result.nfeProc.NFe.infNFe.ide.dhEmi,
                                                                                                                                                                                    tipoEmissao: result.nfeProc.NFe.infNFe.ide.tpEmis,
                                                                                                                                                                                    CnpjEmitente: result.nfeProc.NFe.infNFe.emit.CNPJ,
                                                                                                                                                                                    NomeEmitente: result.nfeProc.NFe.infNFe.emit.xNome,
                                                                                                                                                                                    CnpjDestinatario: result.nfeProc.NFe.infNFe.dest.CNPJ,
                                                                                                                                                                                    NomeDestinatario: result.nfeProc.NFe.infNFe.dest.xNome,
                                                                                                                                                                                    CodigoProduto:  result.nfeProc.NFe.infNFe.det.prod.cProd,
                                                                                                                                                                                    EAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                                                                                                    DescriçaoProduto:  result.nfeProc.NFe.infNFe.det.prod.xProd,
                                                                                                                                                                                    NCM:  result.nfeProc.NFe.infNFe.det.prod.NCM,
                                                                                                                                                                                    CEST:  result.nfeProc.NFe.infNFe.det.prod.CEST,
                                                                                                                                                                                    cEAN:  result.nfeProc.NFe.infNFe.det.prod.cEAN,
                                                                                                                                                                                    CFOP:  result.nfeProc.NFe.infNFe.det.prod.CFOP,
                                                                                                                                                                                    Quantidade:  result.nfeProc.NFe.infNFe.det.prod.qCom,
                                                                                                                                                                                    ValorUnitario:  result.nfeProc.NFe.infNFe.det.prod.vUnCom,
                                                                                                                                                                                    ValorProduto:  result.nfeProc.NFe.infNFe.det.prod.vProd,
                                                                                                                                                                                    CST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.CST._text,
                                                                                                                                                                                    BaseICMS:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vBC,
                                                                                                                                                                                    PorcentICMS: (result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.pICMS),
                                                                                                                                                                                    ValorICMSOper: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vICMSOp,
                                                                                                                                                                                    PorcentDoDiferimento: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.pDif,
                                                                                                                                                                                    ValorICMSDiferido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vICMSDif,
                                                                                                                                                                                    ValorICMS: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vICMS,
                                                                                                                                                                                    BaseDeCalculoFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vBCFCP,
                                                                                                                                                                                    PorcentFCP: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.pFCP,
                                                                                                                                                                                    ValorFECP:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vFCP,
                                                                                                                                                                                    ModalidadeDetBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.ModBCST,
                                                                                                                                                                                    PorcentMVAST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.pMVAST, 
                                                                                                                                                                                    PorcentReducaoBCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.pRedBCST, 
                                                                                                                                                                                    BaseICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vBCST,
                                                                                                                                                                                    AlíquotaICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.pICMSST,
                                                                                                                                                                                    ValorICMSST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vICMSST,
                                                                                                                                                                                    valorBaseCalculoFECPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vBCFCPST,
                                                                                                                                                                                    PorcentFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.pFCPST,                           
                                                                                                                                                                                    valorFeCPST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vFCPST,
                                                                                                                                                                                    ValorICMSDeson: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vICMSDeson,
                                                                                                                                                                                    ValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vBCSTRet, 
                                                                                                                                                                                    AlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.pST,
                                                                                                                                                                                    ICMSPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vICMSSubstituto,
                                                                                                                                                                                    ValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vICMSSTRet,
                                                                                                                                                                                    ValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vBCFCPSTRet,
                                                                                                                                                                                    PorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.pFCPSTRet,
                                                                                                                                                                                    valorFCPSTRetido: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vFCPSTRet,
                                                                                                                                                                                    PorcentReducaoDeBaseCalculo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.pRedBCEfet,
                                                                                                                                                                                    valorDaBaseDeCalculoEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vBCEfet,
                                                                                                                                                                                    aliquotaDoICMSEfetiva: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.pICMSEfet,
                                                                                                                                                                                    valorDoICMSEfetivo:  result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMS90.vICMSEfet,
                                                                                                                                                                                    valorFrete: result.nfeProc.NFe.infNFe.det.prod.vFrete,
                                                                                                                                                                                    valorSeguro: result.nfeProc.NFe.infNFe.det.prod.vSeg,
                                                                                                                                                                                    valorDesconto: result.nfeProc.NFe.infNFe.det.prod.vDesc,
                                                                                                                                                                                    valorOutros: result.nfeProc.NFe.infNFe.det.prod.vOutro,
                                                                                                                                                                                    CSTPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.CST,
                                                                                                                                                                                    valorPIS: result.nfeProc.NFe.infNFe.det.imposto.PIS.vPIS,
                                                                                                                                                                                    CSTCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.CST,
                                                                                                                                                                                    valorCOFINS: result.nfeProc.NFe.infNFe.det.imposto.COFINS.vCOFINS,
                                                                                                                                                                                    // ICMSSTCST: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.orig._text + result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.CST._text,
                                                                                                                                                                                    // ICMSSTValordaBCICMSSTRetidoAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTRet, 
                                                                                                                                                                                    // ICMSSTAlíquotaSupConsFinal: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pST,
                                                                                                                                                                                    // ICMSSTPropSubst: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSubstituto,
                                                                                                                                                                                    // ICMSSTValorICMSSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTRet,
                                                                                                                                                                                    // ICMSSTValorBaseCalculoFECPSTRet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCFCPSTRet,
                                                                                                                                                                                    // ICMSSTPorcentFCPSTRetAnteriormente: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pFCPSTRet,
                                                                                                                                                                                    // BCICMSSTDestino: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vBCSTDest,
                                                                                                                                                                                    // BCICMSSTDestino20: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSSTDest,
                                                                                                                                                                                    // PorcentReducaoBaseCalculoEfet: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pRedBCEfet,
                                                                                                                                                                                    // BaseCaculoEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.pICMSEfet,
                                                                                                                                                                                    // ValorIMCSEfetivo: result.nfeProc.NFe.infNFe.det.imposto.ICMS.ICMSST.vICMSEfet,
                                                                                        
                                                                                                                                                                                }   
                                                                                                                                                                            
                                                                                                                                                                                arrayNota.push(notas)
                                                                            
                                                                            
                                                                                                                                                                            }

    }



 }
console.log (arrayNota)
var remocaoDeText = JSON.stringify(arrayNota)
remocaoDeText = remocaoDeText.replace("Numero":arrayNota[0], '');
// var variavelTratada = JSON.parse(remocaoDeText);
//  console.log(variavelTratada);


let xls = json2xls(variavelTratada);
fs.writeFileSync("acimel.01.xlsx", xls, "binary")
